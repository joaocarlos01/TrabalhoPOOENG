import java.util.ArrayList;
import java.util.Date;
import java.util.List;

import com.joaocarlos.exception.NumeroCartaoDuplicado;
import com.joaocarlos.exception.*;
public class Competicao {
	// =======================================================
    // ===================== ATRIBUTOS =======================
    // =======================================================

	/**
	 * A class </strong> Competição </strong> disponibliza os atributos, metodos e funções necessários à criação de uma competição.
	 * @author João Carlos
	 * @author Francisco Esteves
	 * @version 1.0
	 * @since 07/05/2020
	 */
	
	
	/**
	 * </strong> codigo </strong> recebe o código da competição
	 * </strong> nome </strong>  recebe o nome da competição
	 * </strong> dataInicio </strong> recebe a data de início da competição
	 * </strong> dataFim</strong> recebe a data do fim da competição
	 * </strong> escalao </strong> recebe o escalão da competição
	 ** </strong> List <Equipa> </strong> recebe a lista das equipas
	 * </strong> List <Jogo> </strong> recebe a lista dos jogos
	 */
	private int codigo;
	private String nome;
	private Date dataInicio;
	private Date dataFim;
	private String escalao;
	
	
	private List <Equipa> equipa = new ArrayList <Equipa> ();
	private List <Jogo> jogo = new ArrayList <Jogo>();
    // =======================================================
    // ============ ACESSORES e MODIFICADORES ===============
    // =======================================================
	/**
	 * Conjunto de Acessores e Modificadores que permitem atribuir um valor ao atributo, conseguindo obtê-lo em qualquer lugar
	 */
	public int getCodigo() {
		return codigo;
	}

	public void setCodigo(int codigo) {
		this.codigo = codigo;
	}

	public String getNome() {
		return nome;
	}

	public void setNome(String nome) {
		this.nome = nome;
	}

	public Date getDataInicio() {
		return dataInicio;
	}

	public void setDataInicio(Date dataInicio) {
		this.dataInicio = dataInicio;
	}

	public Date getDataFim() {
		return dataFim;
	}

	public void setDataFim(Date dataFim) {
		this.dataFim = dataFim;
	}

	public String getEscalao() {
		return escalao;
	}

	public void setEscalao(String escalao) {
		this.escalao = escalao;
	}

	public List<Equipa> getEquipa() {
		return equipa;
	}

	public void setEquipa(List<Equipa> equipa) {
		this.equipa = equipa;
	}

	public List<Jogo> getJogo() {
		return jogo;
	}

	public void setJogo(List<Jogo> jogo) {
		this.jogo = jogo;
	}
	

    // =======================================================
    // =================== CONSTRUTORES =====================
    // =======================================================

  
   
    /**
     *  CONSTRUTOR DEFAULT
     */

	public Competicao() {
		
	}

    /**
     *  CONSTRUTOR COM PARÂMETROS
     * @param codigo (int) código da competição
     * @param nome (String) nome da competição
     * @param dataInicio (Date) data do inicio da competição
     * @param dataFim (Date) data do fim da competição
     * @param escalao (String) escalão da competição
     * @param equipa (List<Equipa>) equipas da competição
     * @param jogo (List <Jogo>) jogos da competição
     */

	public Competicao(int codigo, String nome, Date dataInicio, Date dataFim, String escalao) {
		super();
		this.codigo = codigo;
		this.nome = nome;
		this.dataInicio = dataInicio;
		this.dataFim = dataFim;
		this.escalao = escalao;
		
	}


    // =======================================================
    // =================== .COMPORTAMENTOS ==================
    // =======================================================

	
	/**
	 * Este método permite remover uma equipa através do fornecimento do seu código.
	 * @param codigo (int) código identificador da equipa que pretendemos remover.
	 * @return  equipa (Equipa) irá retornar a lista de equipas já alterada.
	 */

	protected List<Equipa> removerEquipa (int codigo) {
		for (Equipa equipa : this.equipa) {
			if (equipa.getCodigo() == codigo ) {
				this.equipa.remove(equipa);
				return this.equipa;
			}
		}
		return equipa;
		}
	/**
	 * 	Método complementar para a obtenção do código dos códigos das equipas
	 * @param codigo (int)
	 * @return equipa (Equipa)
	 */
	protected Equipa getCodigoEquipa (int codigo) {
		for (Equipa equipa : this.equipa) {
			if (equipa.getCodigo()== codigo ) {
				return equipa;
			}
		
		}
		return null;
		}
	/**
	 * Este método permite alterar uma equipa, através do fornecimento do seu código.
	 * @param equipaAposAlteracao (Equipa) equipa que irá substituir a equipa anterior
	 * @param codigo (int) código identificador da equipa que pretendemos remover.
	 */
	
	public void alterarEquipa(int codigo, Equipa equipaAposAlteracao) {
        Equipa equipaAlterada = new Equipa();

        for (Equipa equipa : this.equipa) {
            if (codigo == equipa.getCodigo()) {
                equipaAlterada = equipa;
            }
        }
        int index = this.equipa.indexOf(equipaAlterada);
        this.equipa.set(index, equipaAposAlteracao);

    }
	/**
	 * Este método permite remover um jogo através do fornecimento do seu código.
	 * @param codigo (int) código identificador do jogo que pretendemos remover.
	 * @return  jogo (Jogo) irá retornar a lista de jogos já alterada.
	 */
	
	protected List<Jogo> removerJogo (int codigo) {
		for (Jogo jogo : this.jogo) {
			if (jogo.getCodigo() == codigo ) {
				this.jogo.remove(jogo);
				return this.jogo;
			}
		}
		return jogo;
		}
	/**
	 * Este método permite alterar um jogo, através do fornecimento do seu código.
	 * @param equipaAposAlteracao (Jogo) jogo que irá substituir o jogo anterior
	 * @param codigo (int) código identificador do jogo que pretendemos remover.
	 */

	public void alterarJogo (int codigo, Jogo jogoAposAlteracao) {
		   Jogo jogoAlterado = new Jogo();

	        for (Jogo jogo : this.jogo) {
	            if (codigo == jogo.getCodigo()) {
	                jogoAlterado = jogo;
	            }
	        }
	        int index = this.jogo.indexOf(jogoAlterado);
	        this.jogo.set(index, jogoAposAlteracao);

	}

	
	/**
	 * Este método permite mostrar todos os jogos de uma determinada jornada
	 * @param jornada (int) jornada da competição
	 * @return jogo, se a jornada do parametro for igual à jornada de um dos jogos da competição.
	 * @return null, se não existirem jogos na jornada inserida.
	 */
	public Jogo mostrarJornada (int jornada){
		
		for (Jogo jogo : this.jogo) {
			if (jornada == jogo.getJornada()) {
				return jogo;
			}
		}
		return null;
	}
		
	
	

	/**
	 * Este método permite adicionar uma equipa mediante certas exceções, através do fornecimento do seu código.
	 *Não é possivel adicionar Equipas com o mesmo código
	 *Não é possivel adicionar equipas com escalão diferente da Competição
	 * @param equipa(Equipa) Equipa que se pretende adicionar à competição.
	 */
	public void addEquipa(Equipa equipa) {
		
		
		Equipa codEquipa = this.getCodigoEquipa(equipa.getCodigo());
		
		
		if ( codEquipa != null) {
			throw new NumeroDuplicadoexception(equipa.getCodigo(), equipa.getNome());
		}
		
		
		if (equipa.getEscalao() != this.getEscalao()) {
			throw new IllegalArgumentException("Escalões Diferentes");
		}
		
		
		this.equipa.add(equipa);
		}
		


	/**
	 * 
	 * @param jogo (Jogo) jogo que pretendemos adicionar
	 * @return true, se ambas as equipa pertencerem à competição
	 * @return false, se alguma das equipas não pertencer à competição
	 */

	public boolean validarSeEquipaPertence (Jogo jogo) {
		boolean validacaoVisitada = false;
		boolean validacaoVisitante = false;
		
		
		for (Equipa equipa : this.equipa) {
			if(jogo.getEquipaVisitada().equals(equipa)) {
				validacaoVisitada = true;
			}
			
			if (jogo.getEquipaVisitante().equals(equipa)) {
				validacaoVisitante = true;
			}
		
		}
		if (validacaoVisitada && validacaoVisitante) {
			
			return true;
			
		}
	
		else {
			throw new IllegalArgumentException("As Equipas não pertencem à comeptição");
			
		}
		
		}
	
	
	/**
	 * 	Este método serve de complemnto ao método adicionar jogo.
	 * @param jogo (Jogo) jogo que pretendemos adicionar
	 * @return validação = true, se as equipas não jogarem duas vezes na mesma jornada
	 */
	private boolean validarSeEquipaJogouJornada(Jogo jogo) { 
        boolean jornada = true; 
        for (Jogo jogoAlterado : this.jogo) { 
            if (jogoAlterado.getJornada() == jogo.getJornada()) { 
                if (jogoAlterado.getEquipaVisitada().equals(jogo.getEquipaVisitada()) || jogoAlterado.getEquipaVisitante().equals(jogo.getEquipaVisitada())) { 
                        
                    jornada = false; 
                    throw new IllegalArgumentException("A equipa ja jogou "); 
                            
                } 
                if (jogoAlterado.getEquipaVisitada().equals(jogo.getEquipaVisitante()) ||  jogoAlterado.getEquipaVisitante().equals(jogo.getEquipaVisitante())) { 
                        
                    jornada = false; 
                    throw new IllegalArgumentException("A equipa ja jogou "); 
                } 
            } 
        } 
        return jornada; 
    } 
	
	/**
	 * Este metodo permite adicionar um jogo à competição mediante algumas condições
	 * As equipas têm de pertencer à competição
	 * As equipas não podem ter dois jogos na mesma jornada
	 * @param jogo (Jogo) jogo que pretendemos adicionar
	 */
	public void addJogo (Jogo jogo) {
		
		if (validarSeEquipaJogouJornada(jogo) && validarSeEquipaPertence(jogo)) {
			this.jogo.add(jogo);
		}
		}

	/**
	 * Este metodo permite mostrar todas as equipas presentes na competição
	 * @return nEquipas (List<Equipas>)
	 */
	public List<Equipa> mostrarEquipas() {
		return equipa;
	}
	
	
	
	
    // =======================================================
    // ============== MÉTODOS COMPLEMENTARES ==============
    // =======================================================

    /**
     * Metodo toString permite que sejam visualizados os valores dos atributos
     */
	@Override
	public String toString() {
		return "Competicao [codigo=" + codigo + ", nome=" + nome + ", dataInicio=" + dataInicio + ", dataFim=" + dataFim
				+ ", escalao=" + escalao + ", equipa=" + equipa + ", jogo=" + jogo + "]";
	}
	


    // ----> equals()

}
